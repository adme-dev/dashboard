import{h as v,i as b}from"./DRjXbHxH.js";import{h as I}from"./uVKcrSfY.js";import{r as g,bg as w,g as d,b2 as _}from"./CTkq0g8j.js";const S=/^[^-]+.*-.*[^-]+$/,E=/^[^_]+.*_.*[^_]+$/,D=["arrowleft","arrowright","arrowup","arrowright","tab","escape","enter","backspace"];function x(h,p={}){const i=g([]),s=()=>{i.value.splice(0,i.value.length)},m=w(s,p.chainDelay??800),{macOS:y}=I(),r=v(),K=e=>{if(!e.key)return;const a=/^[a-z]{1}$/i.test(e.key),t=D.includes(e.key.toLowerCase());let c;if(i.value.push(e.key),i.value.length>=2){c=i.value.slice(-2).join("-");for(const n of f.value.filter(l=>l.chained))if(n.key===c){n.enabled&&(e.preventDefault(),n.handler(e)),s();return}}for(const n of f.value.filter(l=>!l.chained))if(e.key.toLowerCase()===n.key&&e.metaKey===n.metaKey&&e.ctrlKey===n.ctrlKey&&!((a||t)&&e.shiftKey!==n.shiftKey)){n.enabled&&(e.preventDefault(),n.handler(e)),s();return}m()},o=d(()=>{const e=r.value?.tagName,a=r.value?.contentEditable;return e==="INPUT"||e==="TEXTAREA"||a==="true"||a==="plaintext-only"?r.value?.name||!0:!1}),f=d(()=>Object.entries(_(h)).map(([e,a])=>{if(!a)return null;let t;e.includes("-")&&e!=="-"&&!e.includes("_")&&!e.match(S)?.length&&console.trace(`[Shortcut] Invalid key: "${e}"`),e.includes("_")&&e!=="_"&&!e.match(E)?.length&&console.trace(`[Shortcut] Invalid key: "${e}"`);const c=e.includes("-")&&e!=="-"&&!e.includes("_");if(c)t={key:e.toLowerCase(),metaKey:!1,ctrlKey:!1,shiftKey:!1,altKey:!1};else{const l=e.toLowerCase().split("_").map(u=>u);t={key:l.filter(u=>!["meta","command","ctrl","shift","alt","option"].includes(u)).join("_"),metaKey:l.includes("meta")||l.includes("command"),ctrlKey:l.includes("ctrl"),shiftKey:l.includes("shift"),altKey:l.includes("alt")||l.includes("option")}}if(t.chained=c,!y.value&&t.metaKey&&!t.ctrlKey&&(t.metaKey=!1,t.ctrlKey=!0),typeof a=="function"?t.handler=a:typeof a=="object"&&(t={...t,handler:a.handler}),!t.handler)return console.trace("[Shortcut] Invalid value"),null;let n=!0;return a.usingInput?typeof a.usingInput=="string"&&(n=o.value===a.usingInput):n=!o.value,t.enabled=n,t}).filter(Boolean));return b("keydown",K)}export{x as d};
