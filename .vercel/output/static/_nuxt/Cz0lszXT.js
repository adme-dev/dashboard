import{d as F,r as g,ac as Q,O as R,b as C,o as x,w as n,i as a,Q as D,f as e,M as b,R as f,e as Y,Y as W,S as X,l as Z,T as ee,j as te,I as oe,J as V,$ as c,G as ae}from"./CTkq0g8j.js";import{_ as le}from"./Djkiha65.js";import{_ as se}from"./DaoG89yK.js";import{_ as ne}from"./CnRxXszP.js";import{_ as ie}from"./Bnt8U3Zn.js";import{_ as k}from"./CwiJf-Bm.js";import{_ as re}from"./CLFnOwF2.js";import{o as de,s as M,_ as ce}from"./BldlXeBP.js";import{_ as N}from"./B-3JYnDR.js";import{a as ue,_ as me}from"./CEF2G4p6.js";import{_ as pe}from"./uVKcrSfY.js";import{_ as _e}from"./6mEnkQ3E.js";import{u as ge,_ as be,g as fe}from"./DTb3Reoh.js";import{_ as ve}from"./BfaPkDiZ.js";import"./GoJfS3Uy.js";import"./BDXzKZ7Z.js";import"./CsZqKFWl.js";import"./DRjXbHxH.js";import"./B6-XcZni.js";import"./CNMwNZYC.js";import"./CG-bWSxC.js";import"./CqG_A43z.js";import"./BnnMNR8E.js";import"./BD5aOVH3.js";import"./DedxDhHy.js";const we={class:"flex justify-end gap-2"},ye=F({__name:"AddModal",setup(I){const d=de({name:M().min(2,"Too short"),email:M().email("Invalid email")}),m=g(!1),r=Q({name:void 0,email:void 0}),u=R();async function v(_){u.add({title:"Success",description:`New customer ${_.data.name} added`,color:"success"}),m.value=!1}return(_,i)=>{const w=D,l=k,y=re,h=ce,S=N;return x(),C(S,{open:e(m),"onUpdate:open":i[3]||(i[3]=p=>f(m)?m.value=p:null),title:"New customer",description:"Add a new customer to the database"},{body:n(()=>[a(h,{schema:e(d),state:e(r),class:"space-y-4",onSubmit:v},{default:n(()=>[a(y,{label:"Name",placeholder:"John Doe",name:"name"},{default:n(()=>[a(l,{modelValue:e(r).name,"onUpdate:modelValue":i[0]||(i[0]=p=>e(r).name=p),class:"w-full"},null,8,["modelValue"])]),_:1}),a(y,{label:"Email",placeholder:"john.doe@example.com",name:"email"},{default:n(()=>[a(l,{modelValue:e(r).email,"onUpdate:modelValue":i[1]||(i[1]=p=>e(r).email=p),class:"w-full"},null,8,["modelValue"])]),_:1}),b("div",we,[a(w,{label:"Cancel",color:"neutral",variant:"subtle",onClick:i[2]||(i[2]=p=>m.value=!1)}),a(w,{label:"Create",color:"primary",variant:"solid",type:"submit"})])]),_:1},8,["schema","state"])]),default:n(()=>[a(w,{label:"New customer",icon:"i-lucide-plus"})]),_:1},8,["open"])}}}),he=Object.assign(ye,{__name:"CustomersAddModal"}),Se={class:"flex justify-end gap-2"},Ue=F({__name:"DeleteModal",props:{count:{default:0}},setup(I){const d=g(!1);async function m(){await new Promise(r=>setTimeout(r,1e3)),d.value=!1}return(r,u)=>{const v=D,_=N;return x(),C(_,{open:e(d),"onUpdate:open":u[1]||(u[1]=i=>f(d)?d.value=i:null),title:`Delete ${r.count} customer${r.count>1?"s":""}`,description:"Are you sure, this action cannot be undone."},{body:n(()=>[b("div",Se,[a(v,{label:"Cancel",color:"neutral",variant:"subtle",onClick:u[0]||(u[0]=i=>d.value=!1)}),a(v,{label:"Delete",color:"error",variant:"solid","loading-auto":"",onClick:m})])]),default:n(()=>[Y(r.$slots,"default")]),_:3},8,["open","title"])}}}),Ce=Object.assign(Ue,{__name:"CustomersDeleteModal"}),xe={class:"flex flex-wrap items-center justify-between gap-1.5"},$e={class:"flex flex-wrap items-center gap-1.5"},Ae={class:"flex items-center justify-between gap-3 border-t border-default pt-4 mt-auto"},Ve={class:"text-sm text-muted"},Fe={class:"flex items-center gap-1.5"},tt=F({__name:"customers",async setup(I){let d,m;const r=ae,u=D,v=le,_=se,i=ne,w=R(),l=W("table"),y=g([{id:"email",value:""}]),h=g(),S=g({1:!0}),{data:p,status:j}=([d,m]=X(()=>ee("/api/customers",{lazy:!0},"$6qzunmRhlq")),d=await d,m(),d);function P(t){return[{type:"label",label:"Actions"},{label:"Copy customer ID",icon:"i-lucide-copy",onSelect(){navigator.clipboard.writeText(t.original.id.toString()),w.add({title:"Copied to clipboard",description:"Customer ID copied to clipboard"})}},{type:"separator"},{label:"View customer details",icon:"i-lucide-list"},{label:"View customer payments",icon:"i-lucide-wallet"},{type:"separator"},{label:"Delete customer",icon:"i-lucide-trash",color:"error",onSelect(){w.add({title:"Customer deleted",description:"The customer has been deleted."})}}]}const T=[{id:"select",header:({table:t})=>c(i,{modelValue:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),"onUpdate:modelValue":o=>t.toggleAllPageRowsSelected(!!o),ariaLabel:"Select all"}),cell:({row:t})=>c(i,{modelValue:t.getIsSelected(),"onUpdate:modelValue":o=>t.toggleSelected(!!o),ariaLabel:"Select row"})},{accessorKey:"id",header:"ID"},{accessorKey:"name",header:"Name",cell:({row:t})=>c("div",{class:"flex items-center gap-3"},[c(r,{...t.original.avatar,size:"lg"}),c("div",void 0,[c("p",{class:"font-medium text-highlighted"},t.original.name),c("p",{class:""},`@${t.original.name}`)])])},{accessorKey:"email",header:({column:t})=>{const o=t.getIsSorted();return c(u,{color:"neutral",variant:"ghost",label:"Email",icon:o?o==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>t.toggleSorting(t.getIsSorted()==="asc")})}},{accessorKey:"location",header:"Location",cell:({row:t})=>t.original.location},{accessorKey:"status",header:"Status",filterFn:"equals",cell:({row:t})=>{const o={subscribed:"success",unsubscribed:"error",bounced:"warning"}[t.original.status];return c(v,{class:"capitalize",variant:"subtle",color:o},()=>t.original.status)}},{id:"actions",cell:({row:t})=>c("div",{class:"text-right"},c(_,{content:{align:"end"},items:P(t)},()=>c(u,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}],U=g("all");Z(()=>U.value,t=>{if(!l?.value?.tableApi)return;const o=l.value.tableApi.getColumn("status");o&&(t==="all"?o.setFilterValue(void 0):o.setFilterValue(t))});const $=g({pageIndex:0,pageSize:10});return(t,o)=>{const B=ie,z=he,K=me,q=k,L=pe,O=Ce,E=_e,J=be,G=ve,H=ue;return x(),C(H,{id:"customers"},{header:n(()=>[a(K,{title:"Customers"},{leading:n(()=>[a(B)]),right:n(()=>[a(z)]),_:1})]),body:n(()=>[b("div",xe,[a(q,{"model-value":e(l)?.tableApi?.getColumn("email")?.getFilterValue(),class:"max-w-sm",icon:"i-lucide-search",placeholder:"Filter emails...","onUpdate:modelValue":o[0]||(o[0]=s=>e(l)?.tableApi?.getColumn("email")?.setFilterValue(s))},null,8,["model-value"]),b("div",$e,[a(O,{count:e(l)?.tableApi?.getFilteredSelectedRowModel().rows.length},{default:n(()=>[e(l)?.tableApi?.getFilteredSelectedRowModel().rows.length?(x(),C(e(u),{key:0,label:"Delete",color:"error",variant:"subtle",icon:"i-lucide-trash"},{trailing:n(()=>[a(L,null,{default:n(()=>[oe(V(e(l)?.tableApi?.getFilteredSelectedRowModel().rows.length),1)]),_:1})]),_:1})):te("",!0)]),_:1},8,["count"]),a(E,{modelValue:e(U),"onUpdate:modelValue":o[1]||(o[1]=s=>f(U)?U.value=s:null),items:[{label:"All",value:"all"},{label:"Subscribed",value:"subscribed"},{label:"Unsubscribed",value:"unsubscribed"},{label:"Bounced",value:"bounced"}],ui:{trailingIcon:"group-data-[state=open]:rotate-180 transition-transform duration-200"},placeholder:"Filter status",class:"min-w-28"},null,8,["modelValue"]),a(e(_),{items:e(l)?.tableApi?.getAllColumns().filter(s=>s.getCanHide()).map(s=>({label:e(ge)(s.id),type:"checkbox",checked:s.getIsVisible(),onUpdateChecked(A){e(l)?.tableApi?.getColumn(s.id)?.toggleVisibility(!!A)},onSelect(A){A?.preventDefault()}})),content:{align:"end"}},{default:n(()=>[a(e(u),{label:"Display",color:"neutral",variant:"outline","trailing-icon":"i-lucide-settings-2"})]),_:1},8,["items"])])]),a(J,{ref_key:"table",ref:l,"column-filters":e(y),"onUpdate:columnFilters":o[2]||(o[2]=s=>f(y)?y.value=s:null),"column-visibility":e(h),"onUpdate:columnVisibility":o[3]||(o[3]=s=>f(h)?h.value=s:null),"row-selection":e(S),"onUpdate:rowSelection":o[4]||(o[4]=s=>f(S)?S.value=s:null),pagination:e($),"onUpdate:pagination":o[5]||(o[5]=s=>f($)?$.value=s:null),"pagination-options":{getPaginationRowModel:e(fe)()},class:"shrink-0",data:e(p),columns:T,loading:e(j)==="pending",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default"}},null,8,["column-filters","column-visibility","row-selection","pagination","pagination-options","data","loading"]),b("div",Ae,[b("div",Ve,V(e(l)?.tableApi?.getFilteredSelectedRowModel().rows.length||0)+" of "+V(e(l)?.tableApi?.getFilteredRowModel().rows.length||0)+" row(s) selected. ",1),b("div",Fe,[a(G,{"default-page":(e(l)?.tableApi?.getState().pagination.pageIndex||0)+1,"items-per-page":e(l)?.tableApi?.getState().pagination.pageSize,total:e(l)?.tableApi?.getFilteredRowModel().rows.length,"onUpdate:page":o[6]||(o[6]=s=>e(l)?.tableApi?.setPageIndex(s-1))},null,8,["default-page","items-per-page","total"])])])]),_:1})}}});export{tt as default};
