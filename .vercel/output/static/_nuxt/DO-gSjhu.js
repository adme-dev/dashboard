import{d as H,g as f,r as E,b as g,o as a,w as y,C as l,f as o,M as t,U as K,j as N,aa as P,i as v,F as k,E as $,J as x,n as S,_ as Q}from"./CTkq0g8j.js";import{_ as W}from"./D0TfP2D2.js";import{_ as R}from"./DsTXvJJt.js";import{_ as tt}from"./DlAUqK2U.js";const et={class:"flex items-start justify-between"},st={class:"flex items-center gap-3"},ot={class:"p-2 bg-gray-100 dark:bg-gray-800 rounded-lg"},nt={class:"text-right"},at={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},rt={class:"text-xs text-muted"},lt={key:0,class:"p-6 pt-0 flex flex-col lg:flex-row lg:items-start flex-1 min-h-0"},ct={class:"flex-shrink-0 flex justify-center"},it={class:"flex items-center justify-center h-[250px] w-[250px]"},dt={key:1,class:"relative flex items-center justify-center"},ut={key:0,class:"relative"},mt={width:"250",height:"250",viewBox:"0 0 300 300",class:"drop-shadow-sm"},xt={class:"transform -rotate-90 origin-center"},ht=["d","fill","title"],pt={class:"absolute inset-0 flex flex-col items-center justify-center text-center"},_t={class:"text-3xl font-bold text-primary mb-1"},ft=["title"],gt={key:1,class:"w-[250px] h-[250px] relative"},yt={class:"absolute inset-0 flex items-center justify-center"},vt={class:"absolute inset-0 flex flex-col items-center justify-center text-center bg-white dark:bg-gray-900 rounded-full w-32 h-32 m-auto border-4 border-gray-100 dark:border-gray-800"},bt={class:"text-xl font-bold text-primary"},wt={key:2,class:"w-[250px] h-[250px] flex items-center justify-center"},kt={class:"text-center"},$t={class:"w-24 h-24 mx-auto mb-4 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center"},Ct={class:"flex-1 lg:pl-8 mt-6 lg:mt-0 min-h-0"},jt={class:"space-y-3 overflow-y-auto max-h-80 p-3 pr-5 scrollbar-thin rounded-lg bg-gray-50/50 dark:bg-gray-800/20"},Mt={class:"flex items-center gap-2"},At={class:"text-sm text-highlighted"},Dt={class:"text-right"},Ft={class:"text-sm font-medium"},Ut={class:"text-xs text-muted"},Et={key:1,class:"p-6 text-sm text-muted flex items-center justify-center min-h-[200px]"},Nt={class:"text-center"},Pt=H({__name:"CategoryDonut.client",props:{categories:{}},setup(B){const b=B,C=["#2563eb","#14b8a6","#f97316","#a855f7","#22c55e","#eab308","#6366f1","#ef4444"],c=f(()=>!b.categories||!Array.isArray(b.categories)?[]:b.categories.filter(e=>e&&typeof e.amount=="number"&&e.amount>0).map((e,s)=>({...e,index:s}))),d=f(()=>c.value.reduce((e,s)=>e+(s.amount||0),0)),p=e=>{const s=typeof e?.index=="number"?e.index:0;return C[s%C.length]},_=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format,w=f(()=>{const e=c.value[0];return!e||d.value===0?"0%":`${(e.amount/d.value*100).toFixed(1)}%`}),j=f(()=>{if(!c.value.length||d.value===0)return[];let e=0;const s=c.value.map(r=>{const i=r.amount/d.value*100,u=e;return e+=i,{...r,percent:i,startPercent:u,endPercent:e,color:p(r)}});return console.log("Chart data generated:",s.length,"segments"),s}),I=(e,s,r=80,i=120)=>{const u=e/100*2*Math.PI,h=s/100*2*Math.PI,n=150,m=150,O=n+i*Math.cos(u),z=m+i*Math.sin(u),J=n+i*Math.cos(h),X=m+i*Math.sin(h),Y=n+r*Math.cos(h),Z=m+r*Math.sin(h),q=n+r*Math.cos(u),G=m+r*Math.sin(u),U=s-e>50?1:0;return[`M ${O} ${z}`,`A ${i} ${i} 0 ${U} 1 ${J} ${X}`,`L ${Y} ${Z}`,`A ${r} ${r} 0 ${U} 0 ${q} ${G}`,"Z"].join(" ")},M=E(!1),A=E(!1);let D=null,F=null;const T=e=>{console.warn("Chart rendering error:",e),A.value=!0,M.value=!1},V=e=>typeof e?.amount=="number"?e.amount:0,L=e=>{if(!e||typeof e.amount!="number")return"";const s=d.value===0?0:e.amount/d.value*100;return`${e.name||"Unknown"}: ${_(e.amount)} (${s.toFixed(1)}%)`};return(e,s)=>{const r=Q,i=W,u=K,h=R;return a(),g(h,{ui:{body:"!p-0",root:"overflow-visible"},class:"h-[430px] flex flex-col"},{header:y(()=>[t("div",et,[t("div",st,[t("div",ot,[v(r,{name:"i-lucide-pie-chart",class:"h-5 w-5 text-gray-600 dark:text-gray-400"})]),s[0]||(s[0]=t("div",null,[t("h3",{class:"text-lg font-semibold"},"Category Distribution"),t("p",{class:"text-sm text-muted"},"Share of spend by expense category")],-1))]),t("div",nt,[t("p",at,x(o(_)(o(d)||0)),1),t("p",rt,x(o(c)?.length||0)+" categories ",1)])])]),default:y(()=>[o(c).length?(a(),l("div",lt,[t("div",ct,[o(M)&&!o(A)?(a(),g(u,{key:0},{fallback:y(()=>[t("div",it,[v(i,{class:"h-[250px] w-[250px] rounded-full"})])]),default:y(()=>[t("div",{class:"relative",onError:T},[o(D)?(a(),g(P(o(D)),{key:0,data:o(c),value:V,color:p,"central-label":o(w),"central-sub-label":"Top category share","central-sub-label-wrap":!0,height:250,width:250},null,8,["data","central-label"])):N("",!0),o(F)?(a(),g(P(o(F)),{key:1,template:L})):N("",!0)],32)]),_:1})):(a(),l("div",dt,[o(j).length>0?(a(),l("div",ut,[(a(),l("svg",mt,[s[1]||(s[1]=t("circle",{cx:"150",cy:"150",r:"120",fill:"none",stroke:"rgb(243 244 246)","stroke-width":"40",class:"dark:stroke-gray-800"},null,-1)),t("g",xt,[(a(!0),l(k,null,$(o(j),n=>(a(),l("path",{key:n.name,d:I(n.startPercent,n.endPercent),fill:n.color,class:"hover:opacity-90 transition-all duration-200 cursor-pointer hover:drop-shadow-md",title:`${n.name}: ${o(_)(n.amount)} (${n.percent.toFixed(1)}%)`,stroke:"white","stroke-width":"1"},null,8,ht))),128))])])),t("div",pt,[t("div",_t,x(o(w)),1),s[2]||(s[2]=t("div",{class:"text-sm text-muted font-medium"},"Top Category",-1)),t("div",{class:"text-xs text-muted mt-1 max-w-[120px] truncate",title:o(c)[0]?.name},x(o(c)[0]?.name||"No data"),9,ft)])])):o(c).length>0?(a(),l("div",gt,[t("div",yt,[(a(!0),l(k,null,$(o(c).slice(0,5),(n,m)=>(a(),l("div",{key:n.name,class:"absolute rounded-full border-8 animate-pulse",style:S({width:`${280-m*30}px`,height:`${280-m*30}px`,borderColor:p(n),opacity:.8-m*.15})},null,4))),128))]),t("div",vt,[t("div",bt,x(o(w)),1),s[3]||(s[3]=t("div",{class:"text-xs text-muted"},"Top Category",-1))])])):(a(),l("div",wt,[t("div",kt,[t("div",$t,[v(r,{name:"i-lucide-pie-chart",class:"h-12 w-12 text-gray-400"})]),s[4]||(s[4]=t("p",{class:"text-sm text-muted"},"No expense data available",-1))])]))]))]),t("div",Ct,[t("ul",jt,[(a(!0),l(k,null,$(o(c),n=>(a(),l("li",{key:n.name,class:"flex items-center justify-between gap-3"},[t("div",Mt,[t("span",{class:"legend-swatch",style:S({background:p(n)})},null,4),t("span",At,x(n.name),1)]),t("div",Dt,[t("div",Ft,x(o(_)(n.amount)),1),t("div",Ut,x(o(d)===0?"0.0%":(n.amount/o(d)*100).toFixed(1)+"%"),1)])]))),128))])])])):(a(),l("div",Et,[t("div",Nt,[v(r,{name:"i-lucide-pie-chart",class:"h-12 w-12 text-muted/50 mx-auto mb-4"}),s[5]||(s[5]=t("p",null,"Expense categories will appear when we detect transactions in this range.",-1))])]))]),_:1})}}}),Vt=Object.assign(tt(Pt,[["__scopeId","data-v-ae1795d5"]]),{__name:"ExpensesCategoryDonut"});export{Vt as default};
