import{d as S,g as y,b,o,w as c,C as i,M as e,i as n,F as d,E as r,j as u,J as l,f as k,n as w,I as _,_ as B,Q as F,D as C}from"./CTkq0g8j.js";import{_ as V}from"./D0TfP2D2.js";import{_ as N}from"./Cs1SCnFX.js";import{_ as $}from"./DsTXvJJt.js";import{_ as z}from"./DlAUqK2U.js";const L={class:"flex items-center justify-between"},O={class:"flex items-center gap-3"},A={key:0,class:"text-right"},T={class:"flex items-center gap-2"},E={class:"text-xs text-muted"},M={key:0,class:"space-y-4"},J={class:"grid grid-cols-3 gap-4"},K={key:1,class:"space-y-6"},Q={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},W={class:"text-center p-4 bg-muted/30 rounded-lg"},X={class:"text-2xl font-bold text-highlighted"},q={class:"text-center p-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg"},G={class:"text-2xl font-bold text-emerald-600 dark:text-emerald-400"},H={class:"text-center p-4 bg-red-50 dark:bg-red-900/20 rounded-lg"},Y={class:"text-2xl font-bold text-red-600 dark:text-red-400"},Z={class:"space-y-3"},ee={class:"relative h-12 bg-border/30 rounded-lg overflow-hidden"},te={class:"flex h-full"},se={key:0,class:"truncate px-2"},ae={class:"grid grid-cols-2 md:grid-cols-5 gap-3 text-sm"},oe={class:"flex items-center gap-2 mb-2"},ie={class:"font-medium text-highlighted"},le={class:"space-y-1"},ne={class:"flex justify-between"},de={class:"font-medium"},re={class:"flex justify-between"},ce={class:"font-medium"},ue={class:"flex justify-between"},me={class:"font-medium"},pe={key:0,class:"space-y-3"},ve={class:"space-y-2"},he={key:1,class:"space-y-3"},_e={class:"space-y-2"},fe={class:"flex gap-2 pt-4 border-t border-border"},xe={key:2,class:"flex items-center justify-center py-12"},ge={class:"text-center"},ye=S({__name:"InvoicePipeline",props:{data:{},loading:{type:Boolean}},setup(I){const m=I,f=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t),x=t=>{switch(t){case"high":return"text-red-500";case"medium":return"text-amber-500";case"low":return"text-emerald-500";default:return"text-neutral-500"}},P=t=>{switch(t){case"high":return"i-lucide-alert-triangle";case"medium":return"i-lucide-alert-circle";case"low":return"i-lucide-shield-check";default:return"i-lucide-help-circle"}},R=["draft","submitted","authorised","overdue","paid"],g=y(()=>m.data?.stages?R.map(t=>({key:t,...m.data.stages[t]})):[]),U=y(()=>{const t=m.data?.summary.totalValue||1;return g.value.map(s=>({...s,widthPercent:Math.max(s.value/t*100,2)}))});return(t,s)=>{const p=B,v=F,h=V,j=N,D=$;return o(),b(D,null,{header:c(()=>[e("div",L,[s[0]||(s[0]=e("div",null,[e("h3",{class:"text-lg font-semibold"},"Invoice Pipeline"),e("p",{class:"text-sm text-muted"},"Revenue collection status")],-1)),e("div",O,[!t.loading&&t.data?(o(),i("div",A,[e("div",T,[n(p,{name:P(t.data.summary.riskLevel),class:C([x(t.data.summary.riskLevel),"h-4 w-4"])},null,8,["name","class"]),e("span",{class:C(["text-sm font-medium",x(t.data.summary.riskLevel)])},l(t.data.summary.riskLevel.toUpperCase())+" RISK ",3)]),e("div",E,l(t.data.summary.averageCollectionTime)+"d avg collection ",1)])):u("",!0),n(v,{icon:"i-lucide-external-link",color:"neutral",variant:"ghost",size:"sm",to:"/invoices"})])])]),default:c(()=>[t.loading?(o(),i("div",M,[e("div",J,[(o(),i(d,null,r(3,a=>n(h,{class:"h-16",key:a})),64))]),n(h,{class:"h-8 w-full"}),n(h,{class:"h-24 w-full"})])):t.data?(o(),i("div",K,[e("div",Q,[e("div",W,[e("div",X,l(f(t.data.summary.totalValue)),1),s[1]||(s[1]=e("div",{class:"text-xs text-muted"},"Total Pipeline",-1))]),e("div",q,[e("div",G,l(t.data.summary.paidRate.toFixed(1))+"% ",1),s[2]||(s[2]=e("div",{class:"text-xs text-muted"},"Collection Rate",-1))]),e("div",H,[e("div",Y,l(t.data.summary.overdueRate.toFixed(1))+"% ",1),s[3]||(s[3]=e("div",{class:"text-xs text-muted"},"Overdue Rate",-1))])]),e("div",Z,[s[7]||(s[7]=e("h4",{class:"text-sm font-medium text-highlighted"},"Pipeline Flow",-1)),e("div",ee,[e("div",te,[(o(!0),i(d,null,r(k(U),a=>(o(),i("div",{key:a.key,class:"flex items-center justify-center text-white text-xs font-medium transition-all duration-300 hover:opacity-80",style:w({width:`${a.widthPercent}%`,backgroundColor:a.color})},[a.widthPercent>10?(o(),i("span",se,l(a.name),1)):u("",!0)],4))),128))])]),e("div",ae,[(o(!0),i(d,null,r(k(g),a=>(o(),i("div",{key:a.key,class:"p-3 border border-border rounded-lg hover:bg-muted/30 transition-colors"},[e("div",oe,[e("div",{class:"w-3 h-3 rounded-full",style:w({backgroundColor:a.color})},null,4),e("span",ie,l(a.name),1)]),e("div",le,[e("div",ne,[s[4]||(s[4]=e("span",{class:"text-muted"},"Count:",-1)),e("span",de,l(a.count),1)]),e("div",re,[s[5]||(s[5]=e("span",{class:"text-muted"},"Value:",-1)),e("span",ce,l(f(a.value)),1)]),e("div",ue,[s[6]||(s[6]=e("span",{class:"text-muted"},"Avg Days:",-1)),e("span",me,l(a.averageDaysInStage),1)])])]))),128))])]),t.data.bottlenecks.length>0?(o(),i("div",pe,[s[8]||(s[8]=e("h4",{class:"text-sm font-medium text-highlighted"},"Pipeline Bottlenecks",-1)),e("div",ve,[(o(!0),i(d,null,r(t.data.bottlenecks,a=>(o(),b(j,{key:a.stage,icon:"i-lucide-alert-triangle",color:"amber",variant:"subtle",title:a.stage.charAt(0).toUpperCase()+a.stage.slice(1),description:a.issue,class:"text-sm"},null,8,["title","description"]))),128))])])):u("",!0),t.data.recommendations.length>0?(o(),i("div",he,[s[9]||(s[9]=e("h4",{class:"text-sm font-medium text-highlighted"},"Recommendations",-1)),e("div",_e,[(o(!0),i(d,null,r(t.data.recommendations,a=>(o(),i("div",{key:a,class:"flex items-start gap-2 text-sm text-muted"},[n(p,{name:"i-lucide-lightbulb",class:"h-4 w-4 text-amber-500 mt-0.5 flex-shrink-0"}),_(" "+l(a),1)]))),128))])])):u("",!0),e("div",fe,[n(v,{size:"sm",color:"neutral",variant:"subtle",to:"/invoices?status=draft"},{default:c(()=>[_(" Review Drafts ("+l(t.data.stages.draft.count)+") ",1)]),_:1}),n(v,{size:"sm",color:"neutral",variant:"subtle",to:"/invoices?status=overdue"},{default:c(()=>[_(" Collect Overdue ("+l(t.data.stages.overdue.count)+") ",1)]),_:1})])])):(o(),i("div",xe,[e("div",ge,[n(p,{name:"i-lucide-file-text",class:"h-12 w-12 text-muted/50 mx-auto mb-4"}),s[10]||(s[10]=e("p",{class:"text-muted"},"No invoice data available",-1)),s[11]||(s[11]=e("p",{class:"text-sm text-muted/70"},"Connect to Xero to see your invoice pipeline",-1))])]))]),_:1})}}}),Pe=Object.assign(z(ye,[["__scopeId","data-v-5e8359cd"]]),{__name:"DashboardInvoicePipeline"});export{Pe as default};
