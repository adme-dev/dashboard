import{_ as Le}from"./Bnt8U3Zn.js";import{d as te,g as A,b as O,o as r,w as u,C as m,M as e,i as n,f as t,F as z,E as T,n as ue,D as U,J as a,U as we,_ as se,r as J,j as D,Q as re,l as Ve,I as E,L as We,aH as ze,O as ge,S as G,T as Y,Z as Te,R as qe}from"./CTkq0g8j.js";import{_ as He}from"./CyduiWUv.js";import{a as Xe,_ as Qe}from"./CEF2G4p6.js";import{_ as Je}from"./BPEqyxMU.js";import{_ as de}from"./D0TfP2D2.js";import{_ as ke}from"./Cs1SCnFX.js";import{_ as ae}from"./DsTXvJJt.js";import Ke from"./Cwu0AZ6A.js";import{_ as $e}from"./DlAUqK2U.js";import{_ as Ge}from"./Djkiha65.js";import{_ as Ye}from"./BpDhuemr.js";import{_ as Ze}from"./CnRxXszP.js";import{_ as et}from"./B-3JYnDR.js";import{u as tt}from"./Bw4b4mUV.js";import"./BD5aOVH3.js";import"./DRjXbHxH.js";import"./BDXzKZ7Z.js";import"./uVKcrSfY.js";import"./aKkr5ZQX.js";import"./CNMwNZYC.js";import"./CqG_A43z.js";import"./CwiJf-Bm.js";import"./B6-XcZni.js";import"./CG-bWSxC.js";import"./CsZqKFWl.js";import"./BnnMNR8E.js";import"./DedxDhHy.js";import"./BqFtdLq9.js";const st={key:0,class:"flex items-center justify-center h-96"},at={class:"text-center"},ot={key:1,class:"space-y-4"},nt={class:"h-96 w-full"},lt={class:"w-full h-96 flex items-center justify-center"},it={class:"w-full h-80 flex items-end justify-center gap-2 px-4"},rt={class:"relative flex flex-col items-center"},dt=["title"],ct={class:"text-xs font-medium mt-1 text-center"},ut={class:"text-xs text-muted text-center leading-tight max-w-16"},mt={class:"flex items-center justify-center h-96"},pt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t border-gray-200 dark:border-gray-800"},ft={class:"text-center"},xt={class:"text-lg font-semibold text-emerald-600"},ht={class:"text-center"},gt={class:"text-lg font-semibold text-red-600"},_t={class:"text-center"},bt={key:2,class:"flex items-center justify-center h-96"},vt={class:"text-center"},yt=te({__name:"WaterfallChart.client",props:{data:{},loading:{type:Boolean}},setup(H){const i=H,o=A(()=>{if(!i.data)return[];const _=[];let b=0;return _.push({category:"Starting Cash",value:i.data.startingBalance,cumulative:i.data.startingBalance,type:"start",color:"#6b7280"}),b=i.data.startingBalance,i.data.inflows.forEach(C=>{_.push({category:C.category,value:C.amount,cumulative:b+C.amount,type:"increase",color:"#10b981"}),b+=C.amount}),i.data.outflows.forEach(C=>{_.push({category:C.category,value:-C.amount,cumulative:b-C.amount,type:"decrease",color:"#ef4444"}),b-=C.amount}),_.push({category:"Ending Cash",value:i.data.endingBalance,cumulative:i.data.endingBalance,type:"end",color:b>i.data.startingBalance?"#10b981":b<i.data.startingBalance?"#ef4444":"#6b7280"}),_}),y=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(Math.abs(_));return(_,b)=>{const C=de,w=we,j=se,x=ae;return r(),O(x,{class:"h-full"},{header:u(()=>b[0]||(b[0]=[e("div",{class:"flex items-center justify-between"},[e("div",null,[e("h3",{class:"text-lg font-semibold"},"Cash Flow Waterfall"),e("p",{class:"text-sm text-muted"}," Visual breakdown of cash flow components ")])],-1)])),default:u(()=>[_.loading?(r(),m("div",st,[e("div",at,[n(C,{class:"h-80 w-full mb-4"}),n(C,{class:"h-4 w-48 mx-auto"})])])):t(o).length>0?(r(),m("div",ot,[e("div",nt,[n(w,null,{fallback:u(()=>[e("div",mt,[n(C,{class:"h-full w-full"})])]),default:u(()=>[e("div",lt,[e("div",it,[(r(!0),m(z,null,T(t(o),(h,P)=>(r(),m("div",{key:P,class:"flex flex-col items-center gap-2",style:ue({minWidth:`${Math.max(60,100/t(o).length)}px`})},[e("div",rt,[e("div",{class:U(["w-12 rounded-t transition-all duration-300 hover:opacity-80 cursor-pointer",{"bg-emerald-500":h.type==="increase","bg-red-500":h.type==="decrease","bg-gray-500":h.type==="start"||h.type==="end"}]),style:ue({height:`${Math.max(20,Math.abs(h.value)/Math.max(...t(o).map(f=>Math.abs(f.value)))*200)}px`}),title:`${h.category}: ${y(h.value)}`},null,14,dt),e("div",ct,a(y(h.value)),1)]),e("div",ut,a(h.category.length>10?h.category.substring(0,10)+"...":h.category),1)],4))),128))])])]),_:1})]),b[4]||(b[4]=e("div",{class:"flex items-center justify-center gap-6 text-sm"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-3 h-3 bg-emerald-500 rounded-full"}),e("span",{class:"text-muted"},"Inflows")]),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-3 h-3 bg-red-500 rounded-full"}),e("span",{class:"text-muted"},"Outflows")]),e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-3 h-3 bg-gray-500 rounded-full"}),e("span",{class:"text-muted"},"Balance")])],-1)),e("div",pt,[e("div",ft,[b[1]||(b[1]=e("p",{class:"text-sm text-muted"},"Total Inflows",-1)),e("p",xt,a(y(_.data?.inflows.reduce((h,P)=>h+P.amount,0)||0)),1)]),e("div",ht,[b[2]||(b[2]=e("p",{class:"text-sm text-muted"},"Total Outflows",-1)),e("p",gt,a(y(_.data?.outflows.reduce((h,P)=>h+P.amount,0)||0)),1)]),e("div",_t,[b[3]||(b[3]=e("p",{class:"text-sm text-muted"},"Net Change",-1)),e("p",{class:U(["text-lg font-semibold",{"text-emerald-600":(_.data?.endingBalance||0)>(_.data?.startingBalance||0),"text-red-600":(_.data?.endingBalance||0)<(_.data?.startingBalance||0),"text-gray-600":(_.data?.endingBalance||0)===(_.data?.startingBalance||0)}])},a(y((_.data?.endingBalance||0)-(_.data?.startingBalance||0))),3)])])])):(r(),m("div",bt,[e("div",vt,[n(j,{name:"i-lucide-bar-chart-3",class:"h-12 w-12 text-muted/50 mx-auto mb-4"}),b[5]||(b[5]=e("p",{class:"text-muted"},"No cash flow data available",-1)),b[6]||(b[6]=e("p",{class:"text-sm text-muted/70"},"Connect to Xero to see your cash flow breakdown",-1))])]))]),_:1})}}}),wt=Object.assign($e(yt,[["__scopeId","data-v-20da611f"]]),{__name:"CashflowWaterfallChart"}),kt={class:"flex items-center justify-between"},$t={class:"flex gap-1"},Ct={key:0,class:"flex items-center justify-center h-96"},Dt={class:"text-center"},Bt={key:1,class:"space-y-6"},jt={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Pt={class:"p-4 bg-emerald-50 dark:bg-emerald-950/20 rounded-lg"},St={class:"flex items-center gap-2 mb-2"},It={class:"text-lg font-bold text-emerald-800 dark:text-emerald-200"},Ut={class:"text-xs text-emerald-600 dark:text-emerald-400"},At={class:"p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg"},Et={class:"flex items-center gap-2 mb-2"},Mt={class:"text-lg font-bold text-blue-800 dark:text-blue-200"},Rt={class:"text-xs text-blue-600 dark:text-blue-400"},Nt={class:"p-4 bg-red-50 dark:bg-red-950/20 rounded-lg"},Ot={class:"flex items-center gap-2 mb-2"},Ft={class:"text-lg font-bold text-red-800 dark:text-red-200"},Lt={class:"text-xs text-red-600 dark:text-red-400"},Vt={class:"h-80 w-full"},Wt={class:"w-full h-80 flex items-center justify-center"},zt={width:"100%",height:"100%",viewBox:"0 0 880 320",preserveAspectRatio:"xMidYMid meet",class:"border border-gray-200 dark:border-gray-700 rounded"},Tt={key:0,transform:"translate(50, 20)"},qt=["points","stroke-dasharray"],Ht=["points"],Xt=["points","stroke-dasharray"],Qt=["y1","y2"],Jt={key:3},Kt=["cx","cy","fill","title"],Gt={class:"text-xs fill-gray-600"},Yt={x:"35",y:"15","text-anchor":"end"},Zt={x:"35",y:"180","text-anchor":"end"},es={x:"35",y:"315","text-anchor":"end"},ts={class:"flex items-center justify-center h-80"},ss={class:"flex items-center justify-center gap-6 text-sm"},as={key:0,class:"flex items-center gap-2"},os={key:1,class:"flex items-center gap-2"},ns={key:2,class:"flex items-center gap-2"},ls={key:1,class:"pt-4 border-t border-gray-200 dark:border-gray-800"},is={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},rs={class:"mt-1"},ds={class:"mt-1"},cs={class:"font-medium text-emerald-600"},us={class:"mt-1"},ms={class:"font-medium text-red-600"},ps={key:2,class:"flex items-center justify-center h-96"},fs={class:"text-center"},_e="#10b981",be="#3b82f6",ve="#ef4444",ee=760,ye=280,xs=te({__name:"ScenarioAnalysis.client",props:{data:{},loading:{type:Boolean}},setup(H){const i=H,o=J("all"),y=(f,l=0)=>{if(typeof f=="number"&&!Number.isNaN(f))return f;const c=Number(f);return Number.isFinite(c)?c:l},_=A(()=>{if(!i.data?.scenarios)return[];const f=i.data.scenarios.combined||[];return f.length?f.map((c,g)=>({date:c.date,index:g,dateFormatted:new Date(c.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),bestCase:y(c.bestCase??c.balance??0),likelyCase:y(c.likelyCase??c.balance??0),worstCase:y(c.worstCase??c.balance??0)})):(i.data.scenarios.likely||[]).map((c,g)=>{const p=i.data?.scenarios.best?.[g],I=i.data?.scenarios.worst?.[g];return{date:c.date,index:g,dateFormatted:new Date(c.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),bestCase:y(p?.bestCase??p?.balance??c.likelyCase??c.balance??0),likelyCase:y(c?.likelyCase??c.balance??0),worstCase:y(I?.worstCase??I?.balance??c.likelyCase??c.balance??0)}})}),b=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(f),C=[{key:"all",label:"All Scenarios",color:"gray",icon:"i-lucide-layers"},{key:"best",label:"Best Case",color:"emerald",icon:"i-lucide-trending-up"},{key:"likely",label:"Most Likely",color:"blue",icon:"i-lucide-target"},{key:"worst",label:"Worst Case",color:"red",icon:"i-lucide-trending-down"}],w=A(()=>{if(!i.data)return null;const f=g=>{if(_.value.length){const I=g==="best"?"bestCase":g==="likely"?"likelyCase":"worstCase";return _.value.map(R=>R[I])}return(i.data.scenarios[g]||[]).map(I=>y(I[`${g}Case`]??I.balance??0))},l=y(i.data.currentCash,0),c=g=>{if(!g.length)return{endBalance:0,minBalance:0,maxBalance:0,shortfallDays:0,changePercent:0};const p=g[g.length-1],I=Math.min(...g),R=Math.max(...g),S=g.filter(q=>q<0).length,v=l!==0?(p-l)/Math.abs(l)*100:0;return{endBalance:p,minBalance:I,maxBalance:R,shortfallDays:S,changePercent:v}};return{best:c(f("best")),likely:c(f("likely")),worst:c(f("worst"))}}),j=A(()=>Math.max(1,_.value.length-1)),x=A(()=>{if(!_.value.length)return{min:0,max:1};const f=_.value.flatMap(g=>[g.bestCase,g.likelyCase,g.worstCase]),l=Math.max(...f,0),c=Math.min(...f,0);if(l===c){const g=l===0?1:Math.abs(l)*.1||1;return{min:c-g,max:l+g}}return{min:c,max:l}}),h=A(()=>{const{min:f,max:l}=x.value;return{top:l,mid:l-(l-f)/2,bottom:f}}),P=f=>{const{min:l,max:c}=x.value,g=c-l||1;return ye-(f-l)/g*ye};return(f,l)=>{const c=re,g=de,p=se,I=we,R=ae;return r(),O(R,{class:"h-full"},{header:u(()=>[e("div",kt,[l[0]||(l[0]=e("div",null,[e("h3",{class:"text-lg font-semibold"},"Scenario Analysis"),e("p",{class:"text-sm text-muted"}," Best case, most likely, and worst case projections ")],-1)),e("div",$t,[(r(),m(z,null,T(C,S=>n(c,{key:S.key,label:S.label,icon:S.icon,color:t(o)===S.key?S.color:"gray",variant:t(o)===S.key?"solid":"ghost",size:"sm",onClick:v=>o.value=S.key},null,8,["label","icon","color","variant","onClick"])),64))])])]),default:u(()=>[f.loading?(r(),m("div",Ct,[e("div",Dt,[n(g,{class:"h-80 w-full mb-4"}),n(g,{class:"h-4 w-48 mx-auto"})])])):t(_).length>0?(r(),m("div",Bt,[t(w)?(r(),m("div",jt,[e("div",Pt,[e("div",St,[n(p,{name:"i-lucide-trending-up",class:"h-4 w-4 text-emerald-600"}),l[1]||(l[1]=e("h4",{class:"font-medium text-emerald-800 dark:text-emerald-200"},"Best Case",-1))]),e("p",It,a(b(t(w).best.endBalance)),1),e("p",Ut,a(t(w).best.changePercent>0?"+":"")+a(t(w).best.changePercent.toFixed(1))+"% change ",1)]),e("div",At,[e("div",Et,[n(p,{name:"i-lucide-target",class:"h-4 w-4 text-blue-600"}),l[2]||(l[2]=e("h4",{class:"font-medium text-blue-800 dark:text-blue-200"},"Most Likely",-1))]),e("p",Mt,a(b(t(w).likely.endBalance)),1),e("p",Rt,a(t(w).likely.changePercent>0?"+":"")+a(t(w).likely.changePercent.toFixed(1))+"% change ",1)]),e("div",Nt,[e("div",Ot,[n(p,{name:"i-lucide-trending-down",class:"h-4 w-4 text-red-600"}),l[3]||(l[3]=e("h4",{class:"font-medium text-red-800 dark:text-red-200"},"Worst Case",-1))]),e("p",Ft,a(b(t(w).worst.endBalance)),1),e("p",Lt,a(t(w).worst.changePercent>0?"+":"")+a(t(w).worst.changePercent.toFixed(1))+"% change ",1)])])):D("",!0),e("div",Vt,[n(I,null,{fallback:u(()=>[e("div",ts,[n(g,{class:"h-full w-full"})])]),default:u(()=>[e("div",Wt,[(r(),m("svg",zt,[l[4]||(l[4]=e("defs",null,[e("pattern",{id:"grid",width:"92",height:"32",patternUnits:"userSpaceOnUse"},[e("path",{d:"M 92 0 L 0 0 0 32",fill:"none",stroke:"#e5e7eb","stroke-width":"1",opacity:"0.3"})])],-1)),l[5]||(l[5]=e("rect",{width:"100%",height:"100%",fill:"url(#grid)"},null,-1)),t(_).length>0?(r(),m("g",Tt,[t(o)==="all"||t(o)==="best"?(r(),m("polyline",{key:0,points:t(_).map((S,v)=>`${v/t(j)*ee},${P(S.bestCase)}`).join(" "),fill:"none",stroke:_e,"stroke-width":"2","stroke-dasharray":t(o)==="best"?"none":"5,5",class:"transition-all duration-300"},null,8,qt)):D("",!0),t(o)==="all"||t(o)==="likely"?(r(),m("polyline",{key:1,points:t(_).map((S,v)=>`${v/t(j)*ee},${P(S.likelyCase)}`).join(" "),fill:"none",stroke:be,"stroke-width":"3",class:"transition-all duration-300"},null,8,Ht)):D("",!0),t(o)==="all"||t(o)==="worst"?(r(),m("polyline",{key:2,points:t(_).map((S,v)=>`${v/t(j)*ee},${P(S.worstCase)}`).join(" "),fill:"none",stroke:ve,"stroke-width":"2","stroke-dasharray":t(o)==="worst"?"none":"5,5",class:"transition-all duration-300"},null,8,Xt)):D("",!0),e("line",{x1:"0",y1:P(0),x2:ee,y2:P(0),stroke:"#6b7280","stroke-width":"1","stroke-dasharray":"4,4",opacity:"0.5"},null,8,Qt),t(o)!=="all"?(r(),m("g",Jt,[(r(!0),m(z,null,T(t(_),(S,v)=>(r(),m("circle",{key:v,cx:v/t(j)*ee,cy:P(S[t(o)==="best"?"bestCase":t(o)==="likely"?"likelyCase":"worstCase"]),r:"3",fill:t(o)==="best"?_e:t(o)==="likely"?be:ve,class:"cursor-pointer hover:r-4 transition-all",title:`${S.dateFormatted}: ${b(S[t(o)==="best"?"bestCase":t(o)==="likely"?"likelyCase":"worstCase"])}`},null,8,Kt))),128))])):D("",!0)])):D("",!0),e("g",Gt,[e("text",Yt,a(b(t(h).top)),1),e("text",Zt,a(b(t(h).mid)),1),e("text",es,a(b(t(h).bottom)),1)])]))])]),_:1})]),e("div",ss,[t(o)==="all"||t(o)==="best"?(r(),m("div",as,l[6]||(l[6]=[e("div",{class:"w-3 h-3 bg-emerald-500 rounded-full"},null,-1),e("span",{class:"text-muted"},"Best Case",-1)]))):D("",!0),t(o)==="all"||t(o)==="likely"?(r(),m("div",os,l[7]||(l[7]=[e("div",{class:"w-3 h-3 bg-blue-500 rounded-full"},null,-1),e("span",{class:"text-muted"},"Most Likely",-1)]))):D("",!0),t(o)==="all"||t(o)==="worst"?(r(),m("div",ns,l[8]||(l[8]=[e("div",{class:"w-3 h-3 bg-red-500 rounded-full"},null,-1),e("span",{class:"text-muted"},"Worst Case",-1)]))):D("",!0)]),t(w)?(r(),m("div",ls,[l[12]||(l[12]=e("h4",{class:"font-medium text-sm mb-3"},"Risk Analysis",-1)),e("div",is,[e("div",null,[l[9]||(l[9]=e("span",{class:"text-muted"},"Probability of Shortfall:",-1)),e("div",rs,[e("span",{class:U(["font-medium",{"text-red-600":t(w).worst.shortfallDays>0,"text-amber-600":t(w).likely.shortfallDays>0,"text-emerald-600":t(w).worst.shortfallDays===0}])},a(t(w).worst.shortfallDays>0?"High":t(w).likely.shortfallDays>0?"Medium":"Low"),3)])]),e("div",null,[l[10]||(l[10]=e("span",{class:"text-muted"},"Upside Potential:",-1)),e("div",ds,[e("span",cs,a(b(t(w).best.endBalance-t(w).likely.endBalance)),1)])]),e("div",null,[l[11]||(l[11]=e("span",{class:"text-muted"},"Downside Risk:",-1)),e("div",us,[e("span",ms,a(b(t(w).likely.endBalance-t(w).worst.endBalance)),1)])])])])):D("",!0)])):(r(),m("div",ps,[e("div",fs,[n(p,{name:"i-lucide-git-branch",class:"h-12 w-12 text-muted/50 mx-auto mb-4"}),l[13]||(l[13]=e("p",{class:"text-muted"},"No scenario data available",-1)),l[14]||(l[14]=e("p",{class:"text-sm text-muted/70"},"Connect to Xero to see scenario analysis",-1))])]))]),_:1})}}}),hs=Object.assign($e(xs,[["__scopeId","data-v-6a01d34d"]]),{__name:"CashflowScenarioAnalysis"}),gs={class:"flex items-center justify-between"},_s={class:"flex items-center gap-2"},bs={key:0,class:"space-y-4"},vs={key:2,class:"space-y-6"},ys={class:"flex items-center gap-3 mb-2"},ws={class:"flex-1"},ks={class:"flex items-center gap-2 mt-1"},$s={class:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2"},Cs={key:0},Ds={class:"font-semibold mb-3 flex items-center gap-2"},Bs={class:"space-y-3"},js={class:"flex items-start gap-3"},Ps={class:"flex-1"},Ss={class:"flex items-center gap-2 mb-1"},Is={class:"font-medium"},Us={class:"text-sm text-muted"},As={key:1},Es={class:"font-semibold mb-3 flex items-center gap-2"},Ms={class:"space-y-3"},Rs={class:"flex items-start gap-3"},Ns={class:"flex-1"},Os={class:"flex items-center gap-2 mb-1"},Fs={class:"font-medium text-red-800 dark:text-red-200"},Ls={class:"text-sm text-red-700 dark:text-red-300"},Vs={key:2},Ws={class:"font-semibold mb-3 flex items-center gap-2"},zs={class:"space-y-3"},Ts={class:"flex items-start gap-3"},qs={class:"flex-1"},Hs={class:"flex items-center gap-2 mb-1"},Xs={class:"font-medium text-emerald-800 dark:text-emerald-200"},Qs={class:"text-sm text-emerald-700 dark:text-emerald-300"},Js={class:"pt-3 border-t border-gray-200 dark:border-gray-800"},Ks={class:"flex items-center justify-between text-xs text-muted"},Gs={key:3,class:"flex items-center justify-center h-48"},Ys={class:"text-center"},Zs=te({__name:"AIInsights",props:{cashflowData:{},invoiceData:{},scenarioData:{},loading:{type:Boolean}},setup(H){const i=H,o=J(null),y=J(!1),_=J(null);async function b(){if(!(!i.cashflowData||!i.invoiceData)){y.value=!0,_.value=null;try{const f=i.invoiceData.outstanding||[],l=i.invoiceData.overdue||[],c={currentCash:i.cashflowData.currentCash||0,projectedEndBalance:i.cashflowData.projectedEndBalance||0,minProjectedBalance:i.cashflowData.minProjectedBalance||0,maxProjectedBalance:i.cashflowData.maxProjectedBalance||0,burnRate:i.cashflowData.dailyBurnRate||0,runway:i.cashflowData.dailyBurnRate>0?i.cashflowData.currentCash/i.cashflowData.dailyBurnRate:365,shortfallCount:i.cashflowData.shortfallDates?.length||0,outstandingReceivables:f.reduce((p,I)=>p+(I.amountDue||0),0),overdueReceivables:l.reduce((p,I)=>p+(I.amountDue||0),0),outstandingCount:f.length,overdueCount:l.length,forecastPeriod:i.cashflowData.forecastPeriod||90,scenarios:i.scenarioData?.summaries},g=await $fetch("/api/ai/cashflow-insights",{method:"POST",body:c});o.value=g}catch(f){_.value=f,console.error("AI Insights Error:",f)}finally{y.value=!1}}}Ve(()=>i.cashflowData,f=>{f&&i.invoiceData&&!y.value&&b()},{immediate:!0});const C={healthy:{color:"emerald",icon:"i-lucide-check-circle",bgColor:"bg-emerald-50 dark:bg-emerald-950/20"},concerning:{color:"amber",icon:"i-lucide-alert-triangle",bgColor:"bg-amber-50 dark:bg-amber-950/20"},critical:{color:"red",icon:"i-lucide-alert-octagon",bgColor:"bg-red-50 dark:bg-red-950/20"}},w={high:{color:"red",label:"High Impact"},medium:{color:"amber",label:"Medium Impact"},low:{color:"gray",label:"Low Impact"}},j={immediate:{color:"red",label:"Immediate",icon:"i-lucide-zap"},"short-term":{color:"amber",label:"Short-term",icon:"i-lucide-clock"},"long-term":{color:"blue",label:"Long-term",icon:"i-lucide-calendar"}},x={collections:"i-lucide-receipt",expenses:"i-lucide-trending-down",funding:"i-lucide-piggy-bank",operations:"i-lucide-settings"},h={high:{color:"red",label:"High"},medium:{color:"amber",label:"Medium"},low:{color:"green",label:"Low"}},P={high:{color:"red",label:"High Effort"},medium:{color:"amber",label:"Medium Effort"},low:{color:"green",label:"Low Effort"}};return(f,l)=>{const c=se,g=re,p=de,I=ke,R=Ge,S=ae;return r(),O(S,{class:"h-full overflow-hidden border-none shadow-none ring-1 ring-black/5 dark:ring-white/5"},{header:u(()=>[e("div",gs,[e("div",_s,[n(c,{name:"i-lucide-brain",class:"h-5 w-5 text-primary"}),l[1]||(l[1]=e("h3",{class:"text-lg font-semibold"},"AI-Powered Insights",-1))]),t(y)?D("",!0):(r(),O(g,{key:0,icon:"i-lucide-refresh-cw",size:"sm",color:"neutral",variant:"ghost",onClick:l[0]||(l[0]=v=>b())}))])]),default:u(()=>[f.loading||t(y)?(r(),m("div",bs,[n(p,{class:"h-20 w-full"}),n(p,{class:"h-32 w-full"}),n(p,{class:"h-24 w-full"})])):t(_)?(r(),O(I,{key:1,icon:"i-lucide-alert-circle",color:"red",variant:"subtle",title:"Unable to generate insights",description:"AI analysis is temporarily unavailable. Please try again later."})):t(o)?(r(),m("div",vs,[e("div",{class:U([C[t(o).healthAssessment.status].bgColor,"p-4 rounded-lg"])},[e("div",ys,[n(c,{name:C[t(o).healthAssessment.status].icon,class:U([`text-${C[t(o).healthAssessment.status].color}-600`,"h-6 w-6"])},null,8,["name","class"]),e("div",ws,[e("h4",{class:U(["font-semibold",`text-${C[t(o).healthAssessment.status].color}-800 dark:text-${C[t(o).healthAssessment.status].color}-200`])}," Financial Health: "+a(t(o).healthAssessment.status.charAt(0).toUpperCase()+t(o).healthAssessment.status.slice(1)),3),e("div",ks,[e("div",$s,[e("div",{class:U([`bg-${C[t(o).healthAssessment.status].color}-500`,"h-2 rounded-full transition-all duration-300"]),style:ue({width:`${t(o).healthAssessment.score}%`})},null,6)]),e("span",{class:U(["text-sm font-medium",`text-${C[t(o).healthAssessment.status].color}-600`])},a(t(o).healthAssessment.score)+"/100 ",3)])])]),e("p",{class:U(["text-sm",`text-${C[t(o).healthAssessment.status].color}-700 dark:text-${C[t(o).healthAssessment.status].color}-300`])},a(t(o).healthAssessment.summary),3)],2),t(o).priorityActions.length>0?(r(),m("div",Cs,[e("h4",Ds,[n(c,{name:"i-lucide-target",class:"h-4 w-4"}),l[2]||(l[2]=E(" Priority Actions ",-1))]),e("div",Bs,[(r(!0),m(z,null,T(t(o).priorityActions,(v,q)=>(r(),m("div",{key:q,class:"p-3 border border-gray-200 dark:border-gray-800 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors"},[e("div",js,[n(c,{name:x[v.category],class:"h-5 w-5 text-primary mt-0.5"},null,8,["name"]),e("div",Ps,[e("div",Ss,[e("h5",Is,a(v.title),1),n(R,{color:w[v.impact].color,variant:"subtle",size:"xs"},{default:u(()=>[E(a(w[v.impact].label),1)]),_:2},1032,["color"]),n(R,{color:j[v.timeframe].color,variant:"outline",size:"xs"},{default:u(()=>[n(c,{name:j[v.timeframe].icon,class:"h-3 w-3 mr-1"},null,8,["name"]),E(" "+a(j[v.timeframe].label),1)]),_:2},1032,["color"])]),e("p",Us,a(v.description),1)])])]))),128))])])):D("",!0),t(o).risks.length>0?(r(),m("div",As,[e("h4",Es,[n(c,{name:"i-lucide-shield-alert",class:"h-4 w-4"}),l[3]||(l[3]=E(" Risk Assessment ",-1))]),e("div",Ms,[(r(!0),m(z,null,T(t(o).risks,(v,q)=>(r(),m("div",{key:q,class:"p-3 bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800 rounded-lg"},[e("div",Rs,[n(c,{name:"i-lucide-alert-triangle",class:"h-5 w-5 text-red-600 mt-0.5"}),e("div",Ns,[e("div",Os,[e("h5",Fs,a(v.risk),1),n(R,{color:h[v.probability].color,variant:"subtle",size:"xs"},{default:u(()=>[E(a(h[v.probability].label)+" Probability ",1)]),_:2},1032,["color"]),n(R,{color:w[v.impact].color,variant:"subtle",size:"xs"},{default:u(()=>[E(a(w[v.impact].label),1)]),_:2},1032,["color"])]),e("p",Ls,[l[4]||(l[4]=e("strong",null,"Mitigation:",-1)),E(" "+a(v.mitigation),1)])])])]))),128))])])):D("",!0),t(o).opportunities.length>0?(r(),m("div",Vs,[e("h4",Ws,[n(c,{name:"i-lucide-lightbulb",class:"h-4 w-4"}),l[5]||(l[5]=E(" Opportunities ",-1))]),e("div",zs,[(r(!0),m(z,null,T(t(o).opportunities,(v,q)=>(r(),m("div",{key:q,class:"p-3 bg-emerald-50 dark:bg-emerald-950/20 border border-emerald-200 dark:border-emerald-800 rounded-lg"},[e("div",Ts,[n(c,{name:"i-lucide-trending-up",class:"h-5 w-5 text-emerald-600 mt-0.5"}),e("div",qs,[e("div",Hs,[e("h5",Xs,a(v.opportunity),1),n(R,{color:P[v.effort].color,variant:"subtle",size:"xs"},{default:u(()=>[E(a(P[v.effort].label),1)]),_:2},1032,["color"])]),e("p",Qs,a(v.benefit),1)])])]))),128))])])):D("",!0),e("div",Js,[e("div",Ks,[e("span",null," Generated by "+a(t(o).metadata.model)+" "+a(t(o).metadata.note?`(${t(o).metadata.note})`:""),1),e("span",null,a(new Date(t(o).metadata.generatedAt).toLocaleString()),1)])])])):(r(),m("div",Gs,[e("div",Ys,[n(c,{name:"i-lucide-brain",class:"h-12 w-12 text-muted/50 mx-auto mb-4"}),l[6]||(l[6]=e("p",{class:"text-muted"},"No data available for AI analysis",-1)),l[7]||(l[7]=e("p",{class:"text-sm text-muted/70"},"Connect to Xero and refresh to get insights",-1))])]))]),_:1})}}}),ea=Object.assign(Zs,{__name:"CashflowAIInsights"}),ta={class:"flex items-center justify-between"},sa={class:"space-y-6"},aa={class:"space-y-2"},oa=["onClick"],na={key:0,class:"w-2 h-2 rounded-full bg-white"},la={class:"flex-1"},ia={class:"font-medium text-sm"},ra={class:"text-xs text-muted"},da={class:"font-medium"},ca={class:"text-xs text-muted"},ua={class:"space-y-3"},ma={class:"p-3 bg-gray-50 dark:bg-gray-900 rounded-lg"},pa={class:"flex items-center gap-2 text-sm"},fa={class:"text-muted"},xa={class:"flex justify-end gap-2"},ha=te({__name:"ExportModal",props:{open:{type:Boolean,default:!1},openModifiers:{}},emits:["update:open"],setup(H){const i=We(H,"open"),o=J({format:"csv",period:"90",includeScenarios:!0,includeWaterfall:!0,includeInvoices:!0}),y=J(!1),_=[{value:"csv",label:"CSV (Excel Compatible)",description:"Comma-separated values for spreadsheet applications"},{value:"excel",label:"Excel Workbook",description:"Multi-sheet Excel file with detailed data"},{value:"json",label:"JSON Data",description:"Raw data format for developers and APIs"}],b=[{value:"30",label:"30 Days",description:"Next 30 days forecast"},{value:"60",label:"60 Days",description:"Next 60 days forecast"},{value:"90",label:"90 Days",description:"Next 90 days forecast"}];async function C(){if(!y.value){y.value=!0;try{const j=new URLSearchParams({format:o.value.format,period:o.value.period,scenarios:o.value.includeScenarios.toString(),waterfall:o.value.includeWaterfall.toString(),download:"true"});if(o.value.format==="excel"){const x=await $fetch(`/api/exports/cashflow?${j}`);if(x.type==="excel")try{const h=await ze(()=>import("./DGuHH-KN.js"),[],import.meta.url),P=h.utils.book_new();x.data.sheets.forEach(f=>{const l=h.utils.aoa_to_sheet(f.data);h.utils.book_append_sheet(P,l,f.name)}),h.writeFile(P,x.filename)}catch(h){throw console.error("XLSX import failed:",h),new Error("Excel export is not available in this environment")}}else{const x=`/api/exports/cashflow?${j}`,h=document.createElement("a");h.href=x,h.download=`cashflow-export-${new Date().toISOString().slice(0,10)}.${o.value.format}`,document.body.appendChild(h),h.click(),document.body.removeChild(h)}i.value=!1,ge().add({title:"Export Successful",description:`Cash flow data exported as ${o.value.format.toUpperCase()}`,icon:"i-lucide-download",color:"green"})}catch(j){console.error("Export failed:",j),ge().add({title:"Export Failed",description:j.message||"Failed to export cash flow data",icon:"i-lucide-alert-circle",color:"red"})}finally{y.value=!1}}}const w=A(()=>{const j=o.value.period==="30"?2:o.value.period==="60"?4:6,x=o.value.format==="excel"?3:o.value.format==="csv"?1:2,h=(o.value.includeScenarios?1.5:0)+(o.value.includeWaterfall?.5:0)+(o.value.includeInvoices?1:0);return Math.round((j+h)*x*10)/10});return(j,x)=>{const h=re,P=Ye,f=Ze,l=se,c=ae,g=et;return r(),O(g,{modelValue:i.value,"onUpdate:modelValue":x[6]||(x[6]=p=>i.value=p),ui:{width:"sm:max-w-md"}},{default:u(()=>[n(c,{ui:{ring:"",divide:"divide-y divide-gray-200 dark:divide-gray-800"}},{header:u(()=>[e("div",ta,[x[7]||(x[7]=e("h3",{class:"text-lg font-semibold"},"Export Cash Flow Data",-1)),n(h,{color:"gray",variant:"ghost",icon:"i-lucide-x",onClick:x[0]||(x[0]=p=>i.value=!1)})])]),footer:u(()=>[e("div",xa,[n(h,{color:"gray",variant:"ghost",onClick:x[5]||(x[5]=p=>i.value=!1),disabled:t(y)},{default:u(()=>x[12]||(x[12]=[E(" Cancel ",-1)])),_:1,__:[12]},8,["disabled"]),n(h,{icon:"i-lucide-download",loading:t(y),onClick:C},{default:u(()=>[E(a(t(y)?"Exporting...":"Export Data"),1)]),_:1},8,["loading"])])]),default:u(()=>[e("div",sa,[e("div",null,[x[8]||(x[8]=e("label",{class:"block text-sm font-medium mb-3"},"Export Format",-1)),e("div",aa,[(r(),m(z,null,T(_,p=>e("div",{key:p.value,class:U(["flex items-start gap-3 p-3 border rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-900 transition-colors",{"border-primary bg-primary/5":t(o).format===p.value,"border-gray-200 dark:border-gray-800":t(o).format!==p.value}]),onClick:I=>t(o).format=p.value},[e("div",{class:U(["w-4 h-4 rounded-full border-2 flex items-center justify-center",{"border-primary bg-primary":t(o).format===p.value,"border-gray-300 dark:border-gray-600":t(o).format!==p.value}])},[t(o).format===p.value?(r(),m("div",na)):D("",!0)],2),e("div",la,[e("div",ia,a(p.label),1),e("div",ra,a(p.description),1)])],10,oa)),64))])]),e("div",null,[x[9]||(x[9]=e("label",{class:"block text-sm font-medium mb-3"},"Forecast Period",-1)),n(P,{modelValue:t(o).period,"onUpdate:modelValue":x[1]||(x[1]=p=>t(o).period=p),options:b,"option-attribute":"label","value-attribute":"value",class:"w-full"},{option:u(({option:p})=>[e("div",null,[e("div",da,a(p.label),1),e("div",ca,a(p.description),1)])]),_:1},8,["modelValue"])]),e("div",null,[x[10]||(x[10]=e("label",{class:"block text-sm font-medium mb-3"},"Include Additional Data",-1)),e("div",ua,[n(f,{modelValue:t(o).includeScenarios,"onUpdate:modelValue":x[2]||(x[2]=p=>t(o).includeScenarios=p),label:"Scenario Analysis",help:"Best/worst/likely case projections"},null,8,["modelValue"]),n(f,{modelValue:t(o).includeWaterfall,"onUpdate:modelValue":x[3]||(x[3]=p=>t(o).includeWaterfall=p),label:"Waterfall Breakdown",help:"Detailed cash flow components"},null,8,["modelValue"]),n(f,{modelValue:t(o).includeInvoices,"onUpdate:modelValue":x[4]||(x[4]=p=>t(o).includeInvoices=p),label:"Outstanding Invoices",help:"Receivables and payables details"},null,8,["modelValue"])])]),e("div",ma,[e("div",pa,[n(l,{name:"i-lucide-info",class:"h-4 w-4 text-blue-500"}),e("span",fa,[x[11]||(x[11]=E(" Estimated file size: ",-1)),e("strong",null,"~"+a(t(w))+" KB",1)])])])])]),_:1})]),_:1},8,["modelValue"])}}}),ga=Object.assign(ha,{__name:"CashflowExportModal"}),_a={class:"flex gap-2"},ba={key:0,class:"space-y-6"},va={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},ya={key:2,class:"space-y-6"},wa={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},ka={class:"flex items-center justify-between"},$a={class:"text-2xl font-bold"},Ca={class:"mt-2 text-xs text-muted"},Da={class:"flex items-center justify-between"},Ba={class:"flex items-center justify-between"},ja={class:"mt-2 text-xs text-muted"},Pa={class:"flex items-center justify-between"},Sa={class:"text-2xl font-bold text-emerald-600"},Ia={class:"mt-2 text-xs text-muted"},Ua={key:0,class:"grid grid-cols-1 xl:grid-cols-3 gap-4"},Aa={class:"flex items-center justify-between"},Ea={class:"space-y-3 text-sm"},Ma={class:"flex items-center justify-between"},Ra={class:"font-medium"},Na={class:"flex items-center justify-between"},Oa={class:"font-medium"},Fa={class:"flex items-center justify-between pt-2 border-t border-default"},La={class:"flex items-center justify-between text-xs"},Va={class:"font-medium"},Wa={class:"flex items-center justify-between text-xs"},za={class:"font-medium"},Ta={class:"flex items-center justify-between"},qa={class:"space-y-3 text-sm"},Ha={class:"flex items-center justify-between"},Xa={class:"font-medium"},Qa={class:"text-xs text-muted"},Ja={class:"flex items-center justify-between"},Ka={class:"font-medium"},Ga={class:"text-xs text-muted"},Ya={class:"flex items-center justify-between"},Za={class:"font-medium"},eo={class:"text-xs text-muted"},to={class:"flex items-center justify-between"},so={class:"font-medium"},ao={class:"text-xs text-muted"},oo={class:"flex items-center justify-between"},no={class:"font-medium"},lo={class:"text-xs text-muted"},io={class:"pt-2 border-t border-default text-xs flex items-center justify-between"},ro={class:"font-semibold text-emerald-600"},co={class:"flex items-center justify-between"},uo={class:"space-y-3 text-sm"},mo={class:"flex items-center justify-between"},po={class:"font-medium"},fo={class:"text-xs text-muted"},xo={class:"flex items-center justify-between"},ho={class:"font-medium"},go={class:"text-xs text-muted"},_o={class:"flex items-center justify-between"},bo={class:"font-medium"},vo={class:"text-xs text-muted"},yo={class:"pt-2 border-t border-default text-xs flex items-center justify-between"},wo={class:"font-semibold text-red-600"},ko={class:"flex items-center justify-between"},$o={class:"flex gap-2"},Co={class:"space-y-6"},Do={class:"space-y-6"},Bo={class:"text-lg font-semibold flex items-center gap-2"},jo={class:"space-y-4"},Po={class:"flex items-center justify-between p-3 bg-emerald-50 dark:bg-emerald-950/20 rounded-lg"},So={class:"text-sm text-emerald-600 dark:text-emerald-400"},Io={class:"text-right"},Uo={class:"font-bold text-emerald-800 dark:text-emerald-200"},Ao={key:0,class:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-950/20 rounded-lg"},Eo={class:"text-sm text-red-600 dark:text-red-400"},Mo={class:"text-right"},Ro={class:"font-bold text-red-800 dark:text-red-200"},No={class:"pt-2 border-t border-gray-200 dark:border-gray-800"},Oo={class:"flex gap-2"},Fo={class:"text-lg font-semibold flex items-center gap-2"},Lo={class:"space-y-4"},Vo={class:"flex flex-wrap items-start justify-between gap-2"},Wo={class:"font-semibold text-base"},zo={class:"text-xs text-muted"},To={key:0,class:"text-xs text-red-500"},qo={class:"flex flex-col items-end gap-1 text-xs"},Ho={key:0,class:"text-muted"},Xo={class:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs text-muted"},Qo={class:"text-sm font-medium text-neutral-900 dark:text-neutral-100"},Jo={class:"text-sm font-medium text-neutral-900 dark:text-neutral-100"},Ko={class:"text-sm font-medium text-neutral-900 dark:text-neutral-100"},Go={class:"text-sm font-medium text-neutral-900 dark:text-neutral-100"},Yo={key:0,class:"space-y-2"},Zo={class:"space-y-1"},en={class:"flex items-center gap-2"},tn={class:"font-semibold text-neutral-900 dark:text-neutral-100"},sn={class:"text-muted"},an={class:"flex items-center gap-2"},on={class:"text-lg font-semibold flex items-center gap-2"},nn={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},ln={class:"space-y-3"},rn={class:"space-y-2"},dn={class:"flex justify-between text-sm"},cn={class:"font-medium text-emerald-600"},un={class:"flex justify-between text-sm"},mn={class:"font-medium"},pn={class:"flex justify-between text-sm"},fn={class:"space-y-3"},xn={class:"space-y-2"},hn={class:"flex justify-between text-sm"},gn={class:"font-medium"},_n={class:"flex justify-between text-sm"},bn={class:"font-medium"},vn={class:"flex justify-between text-sm"},yn={class:"font-medium"},wn={class:"space-y-3"},kn={class:"space-y-2"},$n={class:"flex justify-between text-sm"},Cn={class:"font-medium"},Dn={class:"flex justify-between text-sm"},Bn={class:"font-medium"},jn={class:"flex justify-between text-sm"},Pn={class:"font-medium"},nl=te({__name:"index",async setup(H){let i,o;const{data:y,pending:_,error:b,refresh:C}=([i,o]=G(()=>Y("/api/xero/reports/cash-flow-forecast?days=90","$ITl0nfxEHC")),i=await i,o(),i),{data:w,pending:j,error:x,refresh:h}=([i,o]=G(()=>Y("/api/xero/reports/cash-flow-scenarios?days=90","$umF28GU8xq")),i=await i,o(),i),{data:P,pending:f,error:l,refresh:c}=([i,o]=G(()=>Y("/api/xero/reports/cash-flow-waterfall?period=30","$V35LDDvQLm")),i=await i,o(),i),{data:g,pending:p,error:I,refresh:R}=([i,o]=G(()=>Y("/api/xero/invoices","$8E11KH14lV")),i=await i,o(),i),{data:S,pending:v,error:q,refresh:Ce}=([i,o]=G(()=>Y("/api/xero/reports/bank-summary","$jR5wa_bebx")),i=await i,o(),i),{data:oe,pending:De,error:Be,refresh:je}=([i,o]=G(()=>Y("/api/xero/reports/cash-flow-insights","$AT_5KfJsFo")),i=await i,o(),i),ne=A(()=>_.value||j.value||f.value||p.value||v.value||De.value),me=A(()=>b.value||x.value||l.value||I.value||q.value||Be.value),{isNotificationsSlideoverOpen:Pe}=tt();function k(d){return typeof d!="number"||Number.isNaN(d)?"-":d.toLocaleString("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0})}function Se(d){return typeof d!="number"||Number.isNaN(d)?"-":d.toLocaleString("en-US",{style:"percent",maximumFractionDigits:1})}function Ie(d){return typeof d!="number"||Number.isNaN(d)?"-":`${Math.round(d)} days`}function ce(d){if(!d)return"-";const s=new Date(d);return Number.isNaN(s.getTime())?"-":s.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}function Ue(d){return typeof d!="number"||Number.isNaN(d)?"-":d.toFixed(2)}async function Ae(){await Promise.all([C(),h(),c(),R(),Ce(),je()])}const $=A(()=>{if(!y.value)return null;const d=y.value,s=d.dailyBurnRate>0?d.currentCash/d.dailyBurnRate:null,K=d.currentCash>0?(d.projectedEndBalance-d.currentCash)/d.currentCash*100:0;return{currentCash:d.currentCash,projectedEndBalance:d.projectedEndBalance,changePercent:K,minProjectedBalance:d.minProjectedBalance,maxProjectedBalance:d.maxProjectedBalance,burnRate:d.dailyBurnRate,runway:s,shortfallCount:d.shortfallDates?.length||0}}),F=A(()=>{if(!g.value)return null;const d=g.value.outstanding||[],s=g.value.overdue||[],K=d.reduce((L,Z)=>L+(Z.amountDue||0),0),M=s.reduce((L,Z)=>L+(Z.amountDue||0),0);return{outstandingCount:d.length,outstandingTotal:K,overdueCount:s.length,overdueTotal:M,totalReceivables:K+M}}),X=A(()=>{const d=oe.value?.workingCapital;return d?{currentAssets:d.currentAssets,currentLiabilities:d.currentLiabilities,workingCapital:d.workingCapital,quickRatio:d.quickRatio??null,cashBalance:d.cashBalance}:null}),N=A(()=>{const d=oe.value?.receivables;return d?{draftInvoices:d.draftInvoices,submittedInvoices:d.submittedInvoices,quotes:d.quotes,totalPipeline:(d.quotes?.totalPipeline??0)+(d.submittedInvoices?.total??0)}:null}),W=A(()=>{const d=oe.value?.payables;return d?{draftBills:d.draftBills,submittedBills:d.submittedBills,purchaseOrders:d.purchaseOrders,totalPipeline:(d.purchaseOrders?.totalPipeline??0)+(d.submittedBills?.total??0)}:null}),pe=A(()=>oe.value?.clients?.topOutstanding||[]),fe=A(()=>({data:y.value,loading:ne.value})),le=A(()=>$.value?$.value.shortfallCount>0?"critical":$.value.minProjectedBalance<1e4?"warning":$.value.changePercent<-20?"caution":"healthy":"unknown"),xe={healthy:{color:"emerald",icon:"i-lucide-trending-up"},caution:{color:"amber",icon:"i-lucide-alert-triangle"},warning:{color:"orange",icon:"i-lucide-alert-circle"},critical:{color:"red",icon:"i-lucide-alert-octagon"},unknown:{color:"gray",icon:"i-lucide-help-circle"}},ie=J(!1),Ee=A(()=>[{label:"Reports",to:"/reports"},{label:"Cash Flow",to:"/cashflow"}]);return(d,s)=>{const K=Le,M=se,L=re,Z=He,Me=Qe,Re=Te("UDashboardBreadcrumb"),Ne=Je,he=de,Oe=ke,V=ae,Fe=Xe;return r(),O(Fe,{id:"cashflow"},{header:u(()=>[n(Me,{title:"Cash Flow",description:"Real-time cash position, forecast, and insights"},{leading:u(()=>[n(K)]),right:u(()=>[n(Z,{text:"Notifications",shortcuts:["N"]},{default:u(()=>[n(L,{color:"neutral",variant:"ghost",square:"",onClick:s[0]||(s[0]=B=>Pe.value=!0)},{default:u(()=>[n(M,{name:"i-lucide-bell",class:"size-5"})]),_:1})]),_:1})]),_:1}),n(Ne,null,{left:u(()=>[n(Re,{items:t(Ee)},null,8,["items"])]),right:u(()=>[e("div",_a,[n(L,{icon:xe[t(le)].icon,color:xe[t(le)].color,variant:"subtle",label:t(le).charAt(0).toUpperCase()+t(le).slice(1),size:"sm"},null,8,["icon","color","label"]),n(L,{label:"Refresh",color:"neutral",icon:"i-lucide-refresh-cw",loading:t(ne),onClick:Ae},null,8,["loading"])])]),_:1})]),body:u(()=>[t(ne)?(r(),m("div",ba,[e("div",va,[(r(),m(z,null,T(4,B=>n(he,{class:"h-32",key:B})),64))]),n(he,{class:"h-96"})])):t(me)?(r(),O(Oe,{key:1,icon:"i-lucide-alert-circle",color:"red",variant:"subtle",title:"Failed to load cash flow data",description:t(me).statusMessage||"Please check your connection and try again.",class:"mb-6"},null,8,["description"])):(r(),m("div",ya,[e("div",wa,[n(V,null,{default:u(()=>[e("div",ka,[e("div",null,[s[3]||(s[3]=e("p",{class:"text-sm text-muted"},"Current Cash",-1)),e("p",$a,a(k(t($)?.currentCash)),1)]),n(M,{name:"i-lucide-wallet",class:"h-8 w-8 text-blue-500"})]),e("div",Ca," As of "+a(new Date().toLocaleDateString()),1)]),_:1}),n(V,null,{default:u(()=>[e("div",Da,[e("div",null,[s[4]||(s[4]=e("p",{class:"text-sm text-muted"},"90-Day Projection",-1)),e("p",{class:U(["text-2xl font-bold",{"text-red-600":(t($)?.changePercent||0)<-10,"text-amber-600":(t($)?.changePercent||0)<0,"text-emerald-600":(t($)?.changePercent||0)>0}])},a(k(t($)?.projectedEndBalance)),3)]),n(M,{name:(t($)?.changePercent||0)>=0?"i-lucide-trending-up":"i-lucide-trending-down",class:U([(t($)?.changePercent||0)>=0?"text-emerald-500":"text-red-500","h-8 w-8"])},null,8,["name","class"])]),e("div",{class:U(["mt-2 text-xs",{"text-red-600":(t($)?.changePercent||0)<0,"text-emerald-600":(t($)?.changePercent||0)>0,"text-muted":(t($)?.changePercent||0)===0}])},a((t($)?.changePercent||0)>=0?"+":"")+a(Se((t($)?.changePercent||0)/100))+" change ",3)]),_:1}),n(V,null,{default:u(()=>[e("div",Ba,[e("div",null,[s[5]||(s[5]=e("p",{class:"text-sm text-muted"},"Cash Runway",-1)),e("p",{class:U(["text-2xl font-bold",{"text-red-600":(t($)?.runway||0)<30,"text-amber-600":(t($)?.runway||0)<60,"text-emerald-600":(t($)?.runway||0)>=60}])},a(Ie(t($)?.runway)),3)]),n(M,{name:"i-lucide-timer",class:"h-8 w-8 text-purple-500"})]),e("div",ja," At current burn rate: "+a(k(t($)?.burnRate))+"/day ",1)]),_:1}),n(V,null,{default:u(()=>[e("div",Pa,[e("div",null,[s[6]||(s[6]=e("p",{class:"text-sm text-muted"},"Outstanding Receivables",-1)),e("p",Sa,a(k(t(F)?.totalReceivables)),1)]),n(M,{name:"i-lucide-receipt",class:"h-8 w-8 text-emerald-500"})]),e("div",Ia,a(t(F)?.outstandingCount||0)+" outstanding, "+a(t(F)?.overdueCount||0)+" overdue ",1)]),_:1})]),t(X)||t(N)||t(W)?(r(),m("div",Ua,[t(X)?(r(),O(V,{key:0},{header:u(()=>[e("div",Aa,[s[7]||(s[7]=e("div",null,[e("h3",{class:"text-base font-semibold"},"Working Capital"),e("p",{class:"text-xs text-muted"},"Balance sheet snapshot")],-1)),n(M,{name:"i-lucide-pie-chart",class:"h-5 w-5 text-blue-500"})])]),default:u(()=>[e("div",Ea,[e("div",Ma,[s[8]||(s[8]=e("span",{class:"text-muted"},"Current Assets",-1)),e("span",Ra,a(k(t(X).currentAssets)),1)]),e("div",Na,[s[9]||(s[9]=e("span",{class:"text-muted"},"Current Liabilities",-1)),e("span",Oa,a(k(t(X).currentLiabilities)),1)]),e("div",Fa,[s[10]||(s[10]=e("span",{class:"text-muted"},"Working Capital",-1)),e("span",{class:U(t(X).workingCapital>=0?"text-emerald-600 font-semibold":"text-red-600 font-semibold")},a(k(t(X).workingCapital)),3)]),e("div",La,[s[11]||(s[11]=e("span",{class:"text-muted"},"Quick Ratio",-1)),e("span",Va,a(Ue(t(X).quickRatio)),1)]),e("div",Wa,[s[12]||(s[12]=e("span",{class:"text-muted"},"Cash & Equivalents",-1)),e("span",za,a(k(t(X).cashBalance)),1)])])]),_:1})):D("",!0),t(N)?(r(),O(V,{key:1},{header:u(()=>[e("div",Ta,[s[13]||(s[13]=e("div",null,[e("h3",{class:"text-base font-semibold"},"Revenue Pipeline"),e("p",{class:"text-xs text-muted"},"Pending client billings")],-1)),n(M,{name:"i-lucide-trending-up",class:"h-5 w-5 text-emerald-500"})])]),default:u(()=>[e("div",qa,[e("div",null,[e("div",Ha,[s[14]||(s[14]=e("span",{class:"text-muted"},"Draft Invoices",-1)),e("span",Xa,a(k(t(N).draftInvoices?.total)),1)]),e("p",Qa,a(t(N).draftInvoices?.count||0)+" in preparation",1)]),e("div",null,[e("div",Ja,[s[15]||(s[15]=e("span",{class:"text-muted"},"Submitted Invoices",-1)),e("span",Ka,a(k(t(N).submittedInvoices?.total)),1)]),e("p",Ga,a(t(N).submittedInvoices?.count||0)+" awaiting approval",1)]),e("div",null,[e("div",Ya,[s[16]||(s[16]=e("span",{class:"text-muted"},"Draft Quotes",-1)),e("span",Za,a(k(t(N).quotes?.draft?.total)),1)]),e("p",eo,a(t(N).quotes?.draft?.count||0)+" in scoping",1)]),e("div",null,[e("div",to,[s[17]||(s[17]=e("span",{class:"text-muted"},"Sent Quotes",-1)),e("span",so,a(k(t(N).quotes?.sent?.total)),1)]),e("p",ao,a(t(N).quotes?.sent?.count||0)+" with clients",1)]),e("div",null,[e("div",oo,[s[18]||(s[18]=e("span",{class:"text-muted"},"Accepted Quotes",-1)),e("span",no,a(k(t(N).quotes?.accepted?.total)),1)]),e("p",lo,a(t(N).quotes?.accepted?.count||0)+" ready to invoice",1)]),e("div",io,[s[19]||(s[19]=e("span",{class:"text-muted"},"Total Revenue Pipeline",-1)),e("span",ro,a(k(t(N).totalPipeline)),1)])])]),_:1})):D("",!0),t(W)?(r(),O(V,{key:2},{header:u(()=>[e("div",co,[s[20]||(s[20]=e("div",null,[e("h3",{class:"text-base font-semibold"},"Media & Vendor Commitments"),e("p",{class:"text-xs text-muted"},"Upcoming cash requirements")],-1)),n(M,{name:"i-lucide-trending-down",class:"h-5 w-5 text-red-500"})])]),default:u(()=>[e("div",uo,[e("div",null,[e("div",mo,[s[21]||(s[21]=e("span",{class:"text-muted"},"Draft Bills",-1)),e("span",po,a(k(t(W).draftBills?.total)),1)]),e("p",fo,a(t(W).draftBills?.count||0)+" in review",1)]),e("div",null,[e("div",xo,[s[22]||(s[22]=e("span",{class:"text-muted"},"Submitted Bills",-1)),e("span",ho,a(k(t(W).submittedBills?.total)),1)]),e("p",go,a(t(W).submittedBills?.count||0)+" awaiting approval",1)]),e("div",null,[e("div",_o,[s[23]||(s[23]=e("span",{class:"text-muted"},"Purchase Orders",-1)),e("span",bo,a(k(t(W).purchaseOrders?.totalPipeline)),1)]),e("p",vo,a((t(W).purchaseOrders?.draft?.count||0)+(t(W).purchaseOrders?.submitted?.count||0))+" open commitments",1)]),e("div",yo,[s[24]||(s[24]=e("span",{class:"text-muted"},"Total Cash Obligations",-1)),e("span",wo,a(k(t(W).totalPipeline)),1)])])]),_:1})):D("",!0)])):D("",!0),n(V,{class:"col-span-full"},{header:u(()=>[e("div",ko,[s[25]||(s[25]=e("div",null,[e("h3",{class:"text-lg font-semibold"},"90-Day Cash Flow Forecast"),e("p",{class:"text-sm text-muted"},"Projected daily cash position with inflows and outflows")],-1)),e("div",$o,[n(L,{icon:"i-lucide-download",size:"sm",color:"neutral",variant:"ghost",label:"Export",onClick:s[1]||(s[1]=B=>ie.value=!0)}),n(L,{icon:"i-lucide-settings",size:"sm",color:"neutral",variant:"ghost",label:"Configure"})])])]),default:u(()=>[n(Ke,{data:t(fe)?.data,loading:t(fe)?.loading||!1},null,8,["data","loading"])]),_:1}),e("div",Co,[n(wt,{data:t(P),loading:t(f)},null,8,["data","loading"]),n(hs,{data:t(w),loading:t(j)},null,8,["data","loading"])]),e("div",Do,[n(ea,{"cashflow-data":t(y),"invoice-data":t(g),"scenario-data":t(w),loading:t(ne)},null,8,["cashflow-data","invoice-data","scenario-data","loading"]),n(V,{class:"border-none shadow-none ring-1 ring-black/5 dark:ring-white/5 bg-gradient-to-r from-emerald-50/90 via-white to-white dark:from-emerald-950/30 dark:via-transparent"},{header:u(()=>[e("h3",Bo,[n(M,{name:"i-lucide-file-text",class:"h-5 w-5"}),s[26]||(s[26]=E(" Receivables Summary ",-1))])]),default:u(()=>[e("div",jo,[e("div",Po,[e("div",null,[s[27]||(s[27]=e("p",{class:"font-medium text-emerald-800 dark:text-emerald-200"},"Outstanding",-1)),e("p",So,a(t(F)?.outstandingCount||0)+" invoice"+a((t(F)?.outstandingCount||0)!==1?"s":""),1)]),e("div",Io,[e("p",Uo,a(k(t(F)?.outstandingTotal)),1)])]),t(F)?.overdueCount&&t(F).overdueCount>0?(r(),m("div",Ao,[e("div",null,[s[28]||(s[28]=e("p",{class:"font-medium text-red-800 dark:text-red-200"},"Overdue",-1)),e("p",Eo,a(t(F).overdueCount)+" invoice"+a(t(F).overdueCount!==1?"s":""),1)]),e("div",Mo,[e("p",Ro,a(k(t(F).overdueTotal)),1)])])):D("",!0),e("div",No,[e("div",Oo,[n(L,{label:"View Invoices",color:"neutral",variant:"ghost",size:"sm",icon:"i-lucide-external-link",to:"/invoices"}),n(L,{label:"Send Reminders",color:"primary",variant:"ghost",size:"sm",icon:"i-lucide-mail"})])])])]),_:1}),t(pe).length?(r(),O(V,{key:0,class:"border-none shadow-none ring-1 ring-black/5 dark:ring-white/5 dark:via-transparent"},{header:u(()=>[e("h3",Fo,[n(M,{name:"i-lucide-users",class:"h-5 w-5"}),s[29]||(s[29]=E(" Top Outstanding Clients ",-1))])]),default:u(()=>[e("div",Lo,[(r(!0),m(z,null,T(t(pe),B=>(r(),m("div",{key:B.id,class:"space-y-3 p-4 bg-white/70 dark:bg-white/5 rounded-lg border border-black/5 dark:border-white/5"},[e("div",Vo,[e("div",null,[e("p",Wo,a(B.name),1),e("p",zo,"Outstanding "+a(k(B.outstanding)),1),B.overdue?(r(),m("p",To," Overdue "+a(k(B.overdue))+" ("+a(Math.round((B.overdueRatio||0)*100))+"%) ",1)):D("",!0)]),e("div",qo,[B.creditLimit?(r(),m("span",Ho,"Credit Limit: "+a(k(B.creditLimit)),1)):D("",!0),e("span",{class:U(["inline-flex items-center gap-1 px-2 py-1 rounded-full",B.overdue?"bg-red-50 text-red-600 dark:bg-red-950/20":"bg-emerald-50 text-emerald-600 dark:bg-emerald-950/20"])},[n(M,{name:B.overdue?"i-lucide-alert-triangle":"i-lucide-badge-check",class:"h-4 w-4"},null,8,["name"]),E(" "+a(B.overdue?"Follow up":"On track"),1)],2)])]),e("div",Xo,[e("div",null,[s[30]||(s[30]=e("span",{class:"block uppercase tracking-wide"},"Invoices",-1)),e("span",Qo,a(B.invoiceCount),1)]),e("div",null,[s[31]||(s[31]=e("span",{class:"block uppercase tracking-wide"},"Overdue",-1)),e("span",Jo,a(B.overdueCount),1)]),e("div",null,[s[32]||(s[32]=e("span",{class:"block uppercase tracking-wide"},"Latest Invoice",-1)),e("span",Ko,a(ce(B.latestInvoiceDate)),1)]),e("div",null,[s[33]||(s[33]=e("span",{class:"block uppercase tracking-wide"},"Next Due",-1)),e("span",Go,a(ce(B.earliestDueDate)),1)])]),B.sampleInvoices?.length?(r(),m("div",Yo,[s[34]||(s[34]=e("p",{class:"text-xs font-medium text-muted uppercase tracking-wide"},"Upcoming Invoices",-1)),e("div",Zo,[(r(!0),m(z,null,T(B.sampleInvoices,Q=>(r(),m("div",{key:Q.id,class:"flex items-center justify-between text-xs bg-black/5 dark:bg-white/10 rounded px-2 py-1"},[e("div",en,[e("span",tn,a(Q.number||Q.reference||Q.id?.slice(0,6)),1),e("span",sn,"Due "+a(ce(Q.dueDate)),1)]),e("div",an,[e("span",{class:U(Q.isOverdue?"text-red-500 font-medium":"text-neutral-900 dark:text-neutral-100")},a(k(Q.amountDue)),3)])]))),128))])])):D("",!0)]))),128))])]),_:1})):D("",!0)]),n(V,null,{header:u(()=>[e("h3",on,[n(M,{name:"i-lucide-bar-chart-3",class:"h-5 w-5"}),s[35]||(s[35]=E(" Cash Flow Analysis ",-1))])]),default:u(()=>[e("div",nn,[e("div",ln,[s[39]||(s[39]=e("h4",{class:"font-medium text-sm"},"Projected Range",-1)),e("div",rn,[e("div",dn,[s[36]||(s[36]=e("span",{class:"text-muted"},"Maximum:",-1)),e("span",cn,a(k(t($)?.maxProjectedBalance)),1)]),e("div",un,[s[37]||(s[37]=e("span",{class:"text-muted"},"Current:",-1)),e("span",mn,a(k(t($)?.currentCash)),1)]),e("div",pn,[s[38]||(s[38]=e("span",{class:"text-muted"},"Minimum:",-1)),e("span",{class:U(["font-medium",{"text-red-600":(t($)?.minProjectedBalance||0)<0,"text-amber-600":(t($)?.minProjectedBalance||0)<1e4&&(t($)?.minProjectedBalance||0)>=0}])},a(k(t($)?.minProjectedBalance)),3)])])]),e("div",fn,[s[43]||(s[43]=e("h4",{class:"font-medium text-sm"},"Burn Rate",-1)),e("div",xn,[e("div",hn,[s[40]||(s[40]=e("span",{class:"text-muted"},"Daily:",-1)),e("span",gn,a(k(t($)?.burnRate)),1)]),e("div",_n,[s[41]||(s[41]=e("span",{class:"text-muted"},"Weekly:",-1)),e("span",bn,a(k((t($)?.burnRate||0)*7)),1)]),e("div",vn,[s[42]||(s[42]=e("span",{class:"text-muted"},"Monthly:",-1)),e("span",yn,a(k((t($)?.burnRate||0)*30)),1)])])]),e("div",wn,[s[47]||(s[47]=e("h4",{class:"font-medium text-sm"},"Forecast Period",-1)),e("div",kn,[e("div",$n,[s[44]||(s[44]=e("span",{class:"text-muted"},"Period:",-1)),e("span",Cn,a(t(y)?.forecastPeriod||90)+" days",1)]),e("div",Dn,[s[45]||(s[45]=e("span",{class:"text-muted"},"Data Points:",-1)),e("span",Bn,a(t(y)?.forecast?.length||0),1)]),e("div",jn,[s[46]||(s[46]=e("span",{class:"text-muted"},"Last Updated:",-1)),e("span",Pn,a(new Date().toLocaleDateString()),1)])])])])]),_:1})])),n(ga,{open:t(ie),"onUpdate:open":s[2]||(s[2]=B=>qe(ie)?ie.value=B:null)},null,8,["open"])]),_:1})}}});export{nl as default};
